## Easy

### 1) Your task would be to create a python script to create an encrypted cookie and brute force the login system to gain access . You can use the request and crypto python libraries

```text
import requests
import re
import base64

value = 'admin123'.encode('ascii')
b64_bytes = base64.b64encode(value)
b64_value = b64_bytes.decode('ascii')

url = 'http://localhost:8080/login'
credentials = {'username': 'Kit', 'password': 'Kat'}
cookies = dict(session_id=b64_value)
r = requests.post(url, data=credentials, cookies=cookies)
data = r.json()['flag']
pattern = "[flag{}]"
flag_value = re.sub(pattern,"",data)
print(flag_value)
```
Output: **H4ck3r** <br />

### 2) Make a one line python program to find whether the given year is leap or not.

```text
print("Leap Year") if (all((x % 4 == 0  and x % 100 != 0 or x % 400 == 0 for x in [int(input())]))) else print("Non Leap Year")
```
![Easy-2.png](https://raw.githubusercontent.com/rSrikesh/bi0s-tasks/main/Pentest%20Tasks/Python%20Tasks/Screenshots/Easy-2.png)

## Medium:

Write a chat application using socket programming. Consider a small chat program with two processes A and B: A: Establishing Connection over sockets and sending message/data to the server side/receiver side . B. Receiving connection and send a message/response back . Feel free to use any library functions.

Should include the following security features: ● Symmetric key encryption for confidentiality(You can use any algorithm) ● SHA-512 for integrity ● HMAC for message authentication.

**server.py**

```text
import socket
from cryptography.fernet import Fernet
from hashlib import sha512
from Crypto.Cipher import AES
from Crypto.Util.Padding import pad
import json

username_s = "A"
username_c = "B"

def shared_key(usr_s , usr_c):

    s_key = b"[conn]".join(sorted([usr_s, usr_c]))
    return s_key[:16] if len(s_key) >= 16 else pad(s_key, 16)

key = shared_key(username_s.encode(),username_c.encode())

def load_key():
    return open("mykey.key","rb").read()

def hmac(mssg):
    global key
    mac = AES.new(pad(key, 16), AES.MODE_ECB).encrypt(pad(mssg, 16))
    hash = sha512(mac).digest()
    return hash

def conv_json(mssg , key):
    a = {"message":mssg.hex(),"key":key.hex()}
    a_dump = json.dumps(a)
    return a_dump

def rev_dump(data):
    x = json.loads(data)
    return bytes.fromhex(x["message"]) , bytes.fromhex(x["key"])

symkey = load_key()
f = Fernet(symkey)

new_socket = socket.socket()
hostname = socket.gethostname()
IPAddr = socket.gethostbyname(hostname)
port = 8080
new_socket.bind((hostname,port))
print("Connection Successful")
new_socket.listen(5)
conn , addr = new_socket.accept()
print(username_c + ' has connected.')

while True:
    message = input("A: ")
    enc_message = f.encrypt(message.encode())
    hash = hmac(enc_message)
    data = conv_json(enc_message,hash)
    conn.send(data.encode())
    recv_data = conn.recv(1024)
    enc_mssg , hash_ = rev_dump(recv_data)
    hash_key = hmac(enc_mssg)
    if hash_ == hash_key:
        message_ = f.decrypt(enc_mssg)
        print("B: "+message_.decode())
    else:
        break

```

**client.py**

```text
import socket
from cryptography.fernet import Fernet
from hashlib import sha512
from Crypto.Cipher import AES
from Crypto.Util.Padding import pad
import json

username_s = "A"
username_c = "B"

def shared_key(usr_s , usr_c):

    s_key = b"[conn]".join(sorted([usr_s, usr_c]))
    return s_key[:16] if len(s_key) >= 16 else pad(s_key, 16)

c_key = shared_key(username_s.encode(),username_c.encode())

def hmac(mssg):
    global c_key 
    mac = AES.new(pad(c_key, 16), AES.MODE_ECB).encrypt(pad(mssg, 16))
    hash = sha512(mac).digest()
    return hash

def rev_dump(data):
    x = json.loads(data)
    return bytes.fromhex(x["message"]) , bytes.fromhex(x["key"])
 
def load_key():
    return open("mykey.key","rb").read()

def conv_json(mssg , key):
    a = {"message":mssg.hex(),"key":key.hex()}
    a_dump = json.dumps(a)
    return a_dump
    
fkey = load_key()
f = Fernet(fkey)

client_socket = socket.socket()
c_hostname = socket.gethostname()
c_port = 8080
client_socket.connect((c_hostname, c_port))

while(True):
    recv_data = client_socket.recv(1024)
    message , hash_ = rev_dump(recv_data)
    hash_ckey = hmac(message)
    if hash_ckey == hash_:
        message = f.decrypt(message)
        print("A: "+message.decode())
    else:
        break
    message = input("B: ")
    enc_message = f.encrypt(message.encode())
    hashkey = hmac(enc_message)
    data = conv_json(enc_message,hashkey)
    client_socket.send(data.encode())
```

**mykey.key**

```text
eBwOgmx3s8qzvQ8ozy-bNiHiVJ8ZTZTLgrjQljl0Lao=
```

![Medium Task.gif](https://raw.githubusercontent.com/rSrikesh/bi0s-tasks/main/Pentest%20Tasks/Python%20Tasks/Screenshots/Medium%20Task.gif)

## Hard:

### Sometimes, we'll have to automate stuff in a web browser. Your next task would be automating a file upload feature using selenium web driver , on your preferred browser . For the web app , who's file upload you'll be automating, you can use dvwa . It's easy to install and set up . A simple google search would give resources on how to set it up .

```text
import selenium
from selenium import webdriver
from time import sleep

driver_location = "/snap/bin/chromium.chromedriver"
binary_location = "/usr/bin/chromium-browser"
image_location = "/home/dell/logo.png"

options = webdriver.ChromeOptions()
options.binary_location = binary_location

driver = webdriver.Chrome(executable_path=driver_location,options=options)
driver.get("https://web.whatsapp.com/")

name = input('Enter Name: ')

user = driver.find_element_by_xpath(f'//span[@title = "{name}"]')
user.click()

attachment = driver.find_element_by_xpath('//div[@title = "Attach"]')
attachment.click()

logo = driver.find_element_by_xpath('//input[@accept = "image/*,video/mp4,video/3gpp,video/quicktime"]')
logo.send_keys(image_location)

sleep(4)
send = driver.find_element_by_xpath('//span[@data-icon="send"]')
send.click()
```

![Hard Task.gif](https://raw.githubusercontent.com/rSrikesh/bi0s-tasks/main/Pentest%20Tasks/Python%20Tasks/Screenshots/Hard%20Task.gif)
